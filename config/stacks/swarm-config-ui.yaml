version: "3.8"

services:
  swarm-config-ui:
    image: swarm-config-ui:latest
    environment:
      - NODE_ENV=production
      - GIT_REPO_BASE=/home
      - WORKSPACE_BASE=/var/apps
      - DOMAIN=${DOMAIN:-example.com}
    volumes:
      - /home:/home
      - /var/apps:/var/apps
    networks:
      - kong-net
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 3
      resources:
        limits:
          cpus: "0.5"
          memory: 512M
        reservations:
          cpus: "0.25"
          memory: 256M

networks:
  kong-net:
    external: true
