version: "3.8"

services:
  ui:
    image: swarm-config-ui:latest
    environment:
      - NODE_ENV=production
      - GIT_REPO_BASE=/home
      - WORKSPACE_BASE=/var/apps
    volumes:
      - /home:/home:ro
      - /var/apps:/var/apps
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - /var/apps/swarm-config/.swarm-config:/app/.swarm-config:ro
      - /var/apps/swarm-config/config:/app/config:ro
    networks:
      - kong-net
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 3
      resources:
        limits:
          cpus: "0.5"
          memory: 512M
        reservations:
          cpus: "0.25"
          memory: 256M

networks:
  kong-net:
    external: true
